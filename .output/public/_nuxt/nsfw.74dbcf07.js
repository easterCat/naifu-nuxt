import e from"./AppHeader.e00bc2a3.js";import a from"./client-only.36cb5329.js";import l from"./AppBanner.dbbafb79.js";import t from"./ImageFlur.100d1bb9.js";import{_ as s}from"./AppHeader.vue_vue_type_style_index_0_scoped_2a3485e7_lang.5db35127.js";import o from"./TemplateDetail.219994eb.js";import{u as n}from"./pinia.17670579.js";import{e as u,ad as i,a as r,f as p,d as c,G as d,H as v,J as m,L as _,Z as b,u as g,$ as f,a0 as y,a1 as j,Y as h,W as x,ae as k,i as C,a4 as A,aa as w,a2 as I,N}from"./element-plus.fe53e503.js";import{a as S}from"./shop.d3010ead.js";import{u as G}from"./index.131f7cc9.js";import{l as T}from"./lodash.cb875ed5.js";import{_ as L}from"./entry.d71b1392.js";import"./ShopLayer.94388788.js";import"./AnimationButton.b724bb94.js";import"./dayjs.3bf4ac2a.js";import"./store.e5acb8cd.js";import"./AppAnimate.vue_vue_type_script_setup_true_lang.c1c03cdc.js";import"./plus.c0ce5731.js";import"./close-bold.ada4cf83.js";import"./vuedraggable.03145536.js";import"./sortablejs.91a11583.js";import"./uuid.d56aad75.js";import"./vue3-clipboard-es.62b9b053.js";import"./AppHeader.vue_vue_type_style_index_0_scoped_e57bc06e_lang.35e4e247.js";/* empty css                                                              *//* empty css                                                                  *//* empty css                                                                       *//* empty css                                                                  *//* empty css                                                                  */import"./Icon.fa57f76f.js";import"./LinkList.vue_vue_type_style_index_0_scoped_ca6c464e_lang.c2f4371d.js";/* empty css                                                                */import"./04.e372062b.js";import"./sYw7uX71Xe.38399cea.js";import"./copy-document.12769081.js";const M={class:"template-page page"},B={class:"content"},F={class:"banner-con"},H=["disabled"],z=["selected"],D=["selected"],V={key:0,class:"shadow-xl card card-compact bg-base-100 glass"},$={class:"card-body"},q={class:"card-title"},E={class:"justify-end card-actions"},K=["onClick"],U=["onClick"],X={class:"demo-pagination-block"},Y={key:0,class:"btn-group"},J=["onClick"],R={key:0,class:"btn"},W=["value","onKeyup"],Z=L(u({__name:"nsfw",setup(u){n().vueApp.provide(i,{prefix:Math.floor(1e3*Math.random()),current:0});const{setShop:L}=S(),Z=r(!1),O=r(1),P=r(36),Q=r(0),ee=r(0),ae=r(!1),le=r([]),te=r(null),se=r("Gelbooru"),oe=r(""),ne=r("high");p((()=>{ce()}));const ue=c((()=>Array.from({length:Q.value},((e,a)=>a)).slice(O.value>3?O.value-3:O.value,O.value+3))),ie=e=>{ne.value=e},re=e=>e.replace(/\s+/g,", ").replace(/\s*(，+|,+)\s*/g,", "),pe=T.debounce((async e=>{e!==oe.value&&(oe.value=e,O.value=1,ce())}),1200),ce=async()=>{if(Z.value)return;Z.value=!0;const{TemplateApi:e,DanbooruApi:a}=G();let l=null;l="Noval"===se.value?await e.getTemplatesNoval({pageIndex:O.value,pageSize:P.value}):await a.searchBooruList({pageIndex:O.value,pageSize:P.value,searchText:oe.value}),Z.value=!1,le.value=null==l?void 0:l.templates,ee.value=l.total,Q.value=Math.ceil(ee.value/P.value)},de=e=>{ve(Number(e.target.value))},ve=e=>{O.value=e,ce()},me=()=>{O.value<=1||(O.value=O.value-1,ce())},_e=()=>{O.value=1,ce()},be=()=>{O.value=Q.value,ce()},ge=()=>{O.value>=Q.value||(O.value=O.value+1,ce())},fe=e=>{se.value=e.target.value,"Gelbooru"===e.target.value?(O.value=1,P.value=100,ce()):(O.value=1,P.value=36,ce())};return(n,u)=>{const i=e,r=a,p=l,c=t,S=s,G=A.ElCol,T=A.ElRow,P=o,ee=w("animate-css");return d(),v("div",M,[m(r,null,{default:_((()=>[m(i)])),_:1}),b("div",B,[b("div",F,[m(p,{placeholder:"请输入关键标签",onSearchChange:g(pe)},null,8,["onSearchChange"])]),m(c,{onGetImageFlur:ie},{right:_((()=>[b("select",{class:"w-32 max-w-xs select select-bordered select-sm",disabled:g(Z),onChange:fe},[b("option",{selected:"Noval"===g(se)},"Noval",8,z),b("option",{selected:"Gelbooru"===g(se)},"Gelbooru",8,D)],40,H)])),_:1}),m(T,{class:"list-con",gutter:20},{default:_((()=>[m(r,null,{default:_((()=>[(d(!0),v(f,null,y(g(le),((e,a)=>I((d(),N(G,{key:a,xs:24,sm:12,md:6,lg:4,xl:4},{default:_((()=>{var a;return[e?(d(),v("div",V,[b("figure",null,[m(S,{class:h(["image",{"high-image-blur":"high"===g(ne),"low-image-blur":"low"===g(ne)}]),src:null==e?void 0:e.minify_preview,loading:"lazy"},null,8,["src","class"])]),b("div",$,[b("h2",q,x((null==(a=null==e?void 0:e.name)?void 0:a.length)>20?(null==e?void 0:e.name.slice(0,20))+"...":null==e?void 0:e.name),1),b("p",null,x(null==e?void 0:e.author),1),b("div",E,[b("button",{class:"btn btn-accent btn-sm",onClick:a=>(e=>{"Noval"===se.value?te.value={...e}:te.value={...e,prompt:`masterpiece, best quality, ${re(e.prompt)}`},ae.value=!0})(e)}," 详情 ",8,K),b("button",{class:"btn btn-primary btn-sm",onClick:a=>(e=>{(null==e?void 0:e.prompt.includes("masterpiece"))||(null==e?void 0:e.prompt.includes("Masterpiece"))?L(null==e?void 0:e.prompt):L(`masterpiece, best quality, ${re(null==e?void 0:e.prompt)}`)})(e)}," 购物车 ",8,U)])])])):j("",!0)]})),_:2},1024)),[[ee,{direction:"modifySlideInUp",delay:30*a}]]))),128))])),_:1})])),_:1}),b("div",X,[g(Q)&&g(Q)>0?(d(),v("div",Y,[b("button",{class:"btn btn-outline",onClick:_e},"首页"),b("button",{class:"btn btn-outline",onClick:me},"上一页"),(d(!0),v(f,null,y(g(ue),((e,a)=>(d(),v("button",{key:a,class:h(["btn",{"btn-active":e===g(O)}]),onClick:a=>ve(e)},x(e),11,J)))),128)),g(O)<g(Q)-3?(d(),v("button",R,"...")):j("",!0),b("button",{class:h(["btn",{"btn-active":g(Q)===g(O)}]),onClick:u[0]||(u[0]=e=>ve(g(Q)))},x(g(Q)),3),b("button",{class:"btn btn-outline",onClick:ge},"下一页"),b("button",{class:"btn btn-outline",onClick:be},"尾页"),b("input",{value:g(O),type:"text",placeholder:"go",class:"w-24 max-w-xs input input-bordered",onKeyup:k(de,["enter"])},null,40,W)])):j("",!0)])]),m(P,{modelValue:g(ae),"onUpdate:modelValue":u[1]||(u[1]=e=>C(ae)?ae.value=e:null),"current-template":g(te)},null,8,["modelValue","current-template"])])}}}),[["__scopeId","data-v-5ef7372a"]]);export{Z as default};
