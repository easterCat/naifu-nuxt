import e from"./client-only.36cb5329.js";import{a as l,u as a}from"./index.131f7cc9.js";import{u as t}from"./pinia.17670579.js";import{e as s,ad as n,a as i,f as o,aa as u,G as d,H as r,J as c,L as v,a2 as m,Z as p,$ as f,a0 as k,Y as y,u as h,_,W as b,a1 as g,i as L,x as V,a4 as w,a5 as j,a6 as E}from"./element-plus.fe53e503.js";import{_ as C}from"./delete.c5b0c1fb.js";import{n as x,_ as I,a as M}from"./none.b7ec71a6.js";import{u as S}from"./LinkList.vue_vue_type_style_index_0_scoped_ca6c464e_lang.c2f4371d.js";import{_ as U}from"./entry.0f1f4d34.js";import"./lodash.cb875ed5.js";import"./dayjs.3bf4ac2a.js";import"./uuid.d56aad75.js";import"./store.e5acb8cd.js";const F=e=>(j("data-v-ca6c464e"),e=e(),E(),e),$={class:"link-con"},A={key:0,class:"link-left bg-base-100"},B={class:"link-right"},R=F((()=>p("div",{class:"right-linear"},null,-1))),T={class:"part-list"},D=["data-title","data-index"],G={class:""},H={class:"row"},J=["href"],W=["src"],Y={key:0,class:"hot-link"},Z={class:"opeartion"},q={key:0,class:"icon"},z={key:1,class:"icon"},K=F((()=>p("div",{style:{float:"right"}},"(hot,prompt,online,other)",-1))),N={class:"dialog-footer"},O=U(s({__name:"LinkList",props:{filter:String,showLeftMenu:Boolean},emits:["editEvent","deleteEvent"],setup(s){const{LinkApi:j}=a();t().vueApp.provide(n,{prefix:Math.floor(1e3*Math.random()),current:0});const E=l(),U=i(!1),F=i(0),O=i(!1),P=i(!1),Q=i(""),X=i(),ee=i(""),le=i(""),ae=i(""),te=i(!1),se=i(""),ne=i(null);let ie=null;const oe=async()=>{const{links:e}=await j.getLinks();ie.setLinks(e),ie.setTypes([...new Set(e.map((e=>e.link_type)))])},ue=()=>{P.value=!0,Q.value="add"},de=()=>{P.value=!1,Q.value="",V((()=>{var e;null==(e=X.value)||e.resetFields()}))},re=()=>{"add"===Q.value&&ce(),"edit"===Q.value&&ve()},ce=async()=>{if(200===(await j.addLink({name:ee.value,href:le.value,type:ae.value,hot:te.value,icon:se.value})).code)return de(),V((()=>{oe()})),w.ElMessage({showClose:!0,message:"新建成功",type:"success"})},ve=async()=>{if(200===(await j.updateLink({name:ee.value,href:le.value,type:ae.value,hot:te.value,id:ne.value,icon:se.value})).code)return de(),V((()=>{oe()})),w.ElMessage({showClose:!0,message:"更新成功",type:"success"})};return o((()=>{ie=S(),(async()=>{if(!ie.linkList.length){const{links:e}=await j.getLinks();ie.setLinks(e),ie.setTypes([...new Set(e.map((e=>e.link_type)))])}})(),"1"==`${E.roleId}`&&(O.value=!0,U.value=!0)})),(l,a)=>{const t=e,n=I,i=w.ElIcon,o=M,E=C,S=w.ElInput,ce=w.ElFormItem,ve=w.ElSwitch,me=w.ElForm,pe=w.ElButton,fe=w.ElDialog,ke=u("scroll-to"),ye=u("animate-css");return d(),r("div",$,[c(t,null,{default:v((()=>[s.showLeftMenu?m((d(),r("div",A,[p("ul",null,[(d(!0),r(f,null,k(h(ie).typeList,((e,l)=>m((d(),r("li",{key:l,class:y({active:h(F)===l})},[_(b(e),1)],2)),[[ke,{target:`.part:nth-child(${l+1}) > h2`,container:".link-right",behavior:"smooth",cb:e=>(e=>{F.value=e})(e||0===e?e:l)}]]))),128)),h(O)?(d(),r("button",{key:0,class:"btn-primary btn-block btn",onClick:ue}," 新增链接 ")):g("",!0)])])),[[ye,{direction:"modifySlideInLeft"}]]):g("",!0)])),_:1}),c(t,null,{default:v((()=>[m((d(),r("div",B,[R,p("div",T,[(d(!0),r(f,null,k(h(ie).typeList,((e,l)=>{return d(),r("div",{key:e,id:"media",class:"part","data-title":e,"data-index":l},[p("h2",G,[p("strong",null,b(e),1)]),p("div",H,[(d(!0),r(f,null,k((a=e,a?[...ie.linkList.filter((e=>e.link_type===a))]:[]),((e,l)=>{var a;return d(),r("div",{key:l,class:"item bg-base-100"},[p("a",{href:null==e?void 0:e.href,target:"_blank"},[p("h3",null,[p("img",{src:null!=(a=null==e?void 0:e.icon)?a:h(x)},null,8,W),p("span",null,b(e.name),1),(null==e?void 0:e.hot)?(d(),r("i",Y,[c(i,{color:"red"},{default:v((()=>[c(n)])),_:1})])):g("",!0)]),p("p",null,b((null==e?void 0:e.desc)?null==e?void 0:e.desc:"暂无描述"),1)],8,J),p("div",Z,[h(U)?(d(),r("span",q,[c(o,{onClick:l=>{return a=e,ee.value=a.name,le.value=a.href,ae.value=a.link||a.link_type,te.value=a.hot,se.value=a.icon,ne.value=a.id,P.value=!0,void(Q.value="edit");var a}},null,8,["onClick"])])):g("",!0),h(U)?(d(),r("span",z,[c(E,{onClick:l=>(async e=>{if(200===(await j.deleteLink({id:e})).code)return V((()=>{oe()})),w.ElMessage({showClose:!0,message:"删除成功",type:"success"})})(null==e?void 0:e.id)},null,8,["onClick"])])):g("",!0)])])})),128))])],8,D);var a})),128))])])),[[ye,{direction:"modifySlideInRight"}]])])),_:1}),c(fe,{modelValue:h(P),"onUpdate:modelValue":a[5]||(a[5]=e=>L(P)?P.value=e:null),title:"add"===h(Q)?"新增":"编辑",width:"600px","destroy-on-close":"","before-close":de},{footer:v((()=>[p("span",N,[c(pe,{onClick:de},{default:v((()=>[_("取消")])),_:1}),c(pe,{type:"primary",onClick:re},{default:v((()=>[_("确定")])),_:1})])])),default:v((()=>[p("div",null,[c(me,{ref_key:"ruleFormRef",ref:X,"label-width":"110px"},{default:v((()=>[c(ce,{label:"链接名称"},{default:v((()=>[c(S,{modelValue:h(ee),"onUpdate:modelValue":a[0]||(a[0]=e=>L(ee)?ee.value=e:null)},null,8,["modelValue"])])),_:1}),c(ce,{label:"链接"},{default:v((()=>[c(S,{modelValue:h(le),"onUpdate:modelValue":a[1]||(a[1]=e=>L(le)?le.value=e:null)},null,8,["modelValue"])])),_:1}),c(ce,{label:"Icon"},{default:v((()=>[c(S,{modelValue:h(se),"onUpdate:modelValue":a[2]||(a[2]=e=>L(se)?se.value=e:null)},null,8,["modelValue"])])),_:1}),c(ce,{label:"类别"},{default:v((()=>[c(S,{modelValue:h(ae),"onUpdate:modelValue":a[3]||(a[3]=e=>L(ae)?ae.value=e:null)},null,8,["modelValue"])])),_:1}),K,c(ce,{label:"热门"},{default:v((()=>[c(ve,{modelValue:h(te),"onUpdate:modelValue":a[4]||(a[4]=e=>L(te)?te.value=e:null)},null,8,["modelValue"])])),_:1})])),_:1},512)])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-ca6c464e"]]);export{O as default};
